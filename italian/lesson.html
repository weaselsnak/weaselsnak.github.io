<!doctype html>
<head>
<title>Italian</title>
<link rel="apple-touch-icon" href="/italian/italian-icon.png">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bulma@1.0.0/css/bulma.min.css"
/>
</head>
<body>
    <script>

ADEJECTIVES = [
    'caro',
    'stagionato',
    'biologico',
    'secco',
    'surgelato',
    'bianco',
    'affumicato',
    'crudo',
    'cotto',
    'freddo',
    'caldo',
    'scremato',
    'giallo',
    'al sangue',
    'ben cotta',
    'di media cottura',
    'mista',
    'salutare',
    'mancante'
]

PHRASES = [
    'puoi ripetere, per favore?',
    'come si scrive?',
    'che significa?',
    'come si dice?',
    'io ho una domanda',
    `qual'Ã¨ il tuo fruitto preferito?`,
    'che cosa mangi a pranzo durante la settimana',
    'qual e la tua cucina preferita'
    ]
    
NOUNS = [
    ['backpack', 'zaino', 'm', false],
    ['shirt', 'camicia', 'f', false],
    ['croissant', 'cornetto', 'm', false],
    ['coffee', 'caffe', 'm', true],
    ['cereal', 'ceriale', 'm', false],
    ['pen', 'penna', 'f', false],
    ['pencil', 'matita', 'f', false],
    ['milk', 'latte', 'm', true],
    ['table', 'tavolo', 'm', false],
    ['garlic', 'aglio', 'm', false],
    ['egg', 'uovo', 'm', true],
    ['soup', 'zuppa', 'f', false],
    ['station', 'stazione', 'f', false],
    ['apple', 'mela', 'f', false],
    ['garden', 'giardino' ,'m', false],
    ['night', 'notte' ,'f', false],
    ['ice cream', 'gelato' ,'m', false],
    ['day', 'giorno' ,'m', false],
    ['dolphin', 'delfino' ,'m', false],
    ['wardrobe', 'armadio' ,'m', false],
    ['tiger', 'tigre' ,'f', false],
    ['mouse', 'topo' ,'m', false],
    ['hand', 'mano' ,'f', false],
    ['photo', 'foto' ,'f', false],
    ['radio', 'radio' ,'f', false],
    ['motorobike', 'moto' ,'f', false],
    ['rule', 'regola' ,'f', false],
    ['lesson', 'lezione', 'f', false],
    ['cow', 'mucca', 'f', false],
    ['lion', 'leone', 'm', false],
    ['parsley', 'prezzemolo', 'm', false]

];


IRREGULAR_NOUNS_PLURALS = {
    'caffe': ['caffe'],
    'latte': ['latte'],
    'uovo': ['uova']
};


ENGLISH_VERBS = [
'to be',
'to have',
'to do/to make',
'to speak',
'to go',
'to know',
'to think',
'to take',
'to see',
'to drink',
'to find',
'to look for',
'to learn',
'can/to be able to',
'to want/desire',
'to have to',
'to exit/leave',
'to say',
'to arrive/approach/come',
'to sell',
'to enter',
'to pay for',
'to run',
'to prefer/favourite'
];

const ITALIAN_VERBS = [
['essere', true],
['avere', true],
['fare', true],
['parlare', false],
['andare', true],
['sapere', true],
['pensare', false],
['prendere', false],
['vedere', false],
['bere', true],
['trovare', false],
['cercare', true],
['imparare', false],
['potere', true],
['volere', true],
['dovere', true],
['uscire', true],
['dire', true],
['venire', true],
['vendere', false],
['entrare', false],
['pagare', true],
['correre', false],
['preferito', true]
];

IRREGULAR_CONJUGATIONS = {
   'essere': ['sono', 'sei', 'e', 'siamo', 'siete', 'sono'],
   'avere': ['ho', 'hai', 'ha', 'abbiamo', 'avete', 'hanno'],
   'fare': ['faccio', 'fai', 'fa', 'facciamo', 'fate', 'fanno'],
   'sapere': ['so', 'sai', 'sa', 'sappiamo', 'sapete', 'sanno'],
   'bere': ['bevo', 'bevi', 'beve', 'beviamo', 'bevete', 'bevono'],
   'cercare': ['cerco', 'cerchi', 'cerca', 'cerchiamo', 'cercate', 'cercano'],
   'andare': ['vado', 'vai', 'va', 'andiamo', 'andate', 'vanno'],
   'potere': ['posso', 'puoi', 'puo', 'possiamo', 'potete', 'possono'],
   'volere': ['voglio', 'vuoi', 'vuole', 'vogliamo', 'volete', 'vogliono'],
   'dovere': ['devo', 'devi', 'deve', 'dobbiamo', 'dovete', 'devono'],
   'uscire': ['esco', 'esci', 'esce', 'usciamo', 'uscite', 'escono'],
   'dire': ['dico', 'dici', 'dice', 'diciamo', 'dite', 'dicono'],
   'venire': ['vengo', 'vieni', 'viene', 'veniamo', 'venite', 'vengono'],
   'pagare': ['pago', 'paghi', 'paga', 'paghiamo', 'pagate', 'pagano'],
   'preferito': ['preferisco', 'preferisci', 'preferisce', 'preferiamo', 'preferite', 'preferiscono']
};

        const ARTICLES = ['a', 'the', 'plural']
        const PRONOUNS = ['I', 'you', 'he/she', 'we', 'you (plural)', 'they']
        const areSuffixes = ['o', 'i', 'a', 'iamo', 'ate', 'ano']
        const ereSuffixes = ['o', 'i', 'e', 'iamo', 'ete', 'ono']

        function isVowel(character) {
            if (character == "a" || character == "e" || character == "i" || character == "o" || character == "u") {
                return true
            } else {
                return false
            }
        }

        function masculineArticle(noun, article) {
            // if the first leter is x, y, or z or the first 2 letters are consonants
            let isSpecial = noun.match(/^(x|y|z)/) || (!isVowel(noun[0]) && !isVowel(noun[1]))
            let beginsWithVowel = isVowel(noun[0])
            if (article == "a") {
                if (isSpecial) {
                    return "uno"
                } else {
                    return "un"
                }
            }
            if (article == "the") {
                if (isSpecial) {
                    return "lo"
                } else if (beginsWithVowel) {
                    return "l'"
                } else {
                    return "il"
                }
            }
            if (article == "plural") {
                if (isSpecial || beginsWithVowel) {
                    return "gli"
                } else {
                    return "i"
                }
            }
        }
        function feminineArticle(noun, article) {
            let beginsWithVowel = isVowel(noun[0])
            if (article == "a") {
                if (beginsWithVowel) {
                    return "un'"
                } else {
                    return "una"
                }
            }
            if (article == "the") {
                if (beginsWithVowel) {
                    return "l'"
                } else {
                    return "la"
                }
            }
            if (article == "plural") {
                    return "le"
            }
        }

        function pluralFeminineNoun(noun) {
            let endsinE = noun.match(/e$/)
            let endsinA = noun.match(/a$/)
            if (endsinE) {
                return noun.replace(/\w$/, 'i');
            }
            if (endsinA) {
                return noun.replace(/\w$/, 'e');
            }
        }
        function pluralMasculineNoun(noun) {
            return noun.replace(/\w$/, 'i');
        }

        function checkVocabAnswer(nounIndex, articleIndex, answer) {
            let [englishNoun, italianNoun, gender, irregular] = NOUNS[nounIndex];
            let article = ARTICLES[articleIndex];
            let italianArticle;
            if (gender == 'f') {
                italianArticle = feminineArticle(italianNoun, article);
                if (article == "plural") {
                    italianNoun = pluralFeminineNoun(italianNoun)
                }
            } else {
                italianArticle = masculineArticle(italianNoun, article);
                if (article == "plural") {
                    italianNoun = pluralMasculineNoun(italianNoun)
                }
            }
            let expectedAnswer
            if (italianArticle == "un'" || italianArticle == "l'") {
                expectedAnswer = italianArticle + italianNoun;
            } else {
                expectedAnswer = italianArticle + " " + italianNoun;
            }
            console.log("expected answer %s", expectedAnswer)
            if (answer == expectedAnswer) {
                return true
            }
            return false
        }

        function checkAnswer(verbIndex, pronounIndex, answer) {
            const [verb, irregular] = ITALIAN_VERBS[verbIndex];
            let verbWithoutSuffix;
            let suffixes;
            if (verb.match(/are$/)) {
                verbWithoutSuffix = verb.replace(/are$/, '');
                suffixes = areSuffixes;
            }
            if (verb.match(/ere$/)) {
                verbWithoutSuffix = verb.replace(/ere$/, '');
                suffixes = ereSuffixes;
            }
            let expectedAnswer;
            if (irregular) {
                expectedAnswer = IRREGULAR_CONJUGATIONS[verb][pronounIndex];
            } else {
                expectedAnswer = verbWithoutSuffix + suffixes[pronounIndex]
            }
            console.log("expected answer %s",expectedAnswer)
            if (answer == expectedAnswer) {
                return true
            }
            return false
        }
    </script>
    <main class="p-2" x-data="{ selected: null }">
        <h2 class="title">select what you want to practice</h2>
        <button class="button is-link" @click="selected = 'verbs'">verbs</button>
        <button class="button is-link" @click="selected = 'vocab'">vocabulary</button>
        <button class="button is-link" @click="selected = 'phrases'">phrases</button>

        <section class="content" x-show="selected == 'verbs'" x-data="{
            chosenVerb: 0,
            chosenPronoun: 0,
            answer: '',
            check() {
                if (checkAnswer(this.chosenVerb, this.chosenPronoun, this.answer)) {
                    alert('you are correct')
                    const chooseAgainBtn = document.getElementById('chooseAgainBtn');
                    chooseAgainBtn.click();
                } else {
                    alert('you are incorrect')
                }
            }
        }"></br>
            <dl>
            <dt>You have chosen verb:</dt>
            <dd><b x-text="ENGLISH_VERBS[chosenVerb]"></b></dd>
            
            <dt>and pronoun:</dt>
            <dd><b x-text="PRONOUNS[chosenPronoun]"></b></dd>
            
            </dl>
            <form @submit.prevent="check()">
                <input required="required" spellcheck="false" autocorrect="off" autocapitalize="off" autocomplete="off" class="input" type="text" x-model="answer" x-ref="answerInput" placeholder="your answer here...">
                <button class="button is-info mt-2" type="submit">check answer</button>
            </form>
            <footer class="mt-2">
            <button id="chooseAgainBtn" class="button is-warning" @click="chosenVerb = Math.floor(Math.random()*ENGLISH_VERBS.length); chosenPronoun = Math.floor(Math.random()*PRONOUNS.length); answer = ''; $refs.answerInput.focus()">choose again</button>
            </footer>
        </section>

        <section class="content" x-show="selected == 'vocab'" x-data="{
            chosenNoun: 0,
            chosenArticle: 0,
            answer: '',
            check() {
                if (checkVocabAnswer(this.chosenNoun, this.chosenArticle, this.answer)) {
                    alert('you are correct')
                    const chooseNounBtn = document.getElementById('chooseNounBtn');
                    chooseNounBtn.click();
                } else {
                    alert('you are incorrect')
                }
            }
        }"></br>
            <dl>
            <dt>You have chosen noun:</dt>
            <dd><b x-text="NOUNS[chosenNoun][0]"></b></dd>
            
            <dt>and article:</dt>
            <dd><b x-text="ARTICLES[chosenArticle]"></b></dd>
            
            </dl>
            <form @submit.prevent="check()">
                <input required="required" spellcheck="false" autocorrect="off" autocapitalize="off" autocomplete="off" class="input" type="text" x-model="answer" x-ref="answerInput" placeholder="your answer here...">
                <button class="button is-info mt-2" type="submit">check answer</button>
            </form>
            <footer class="mt-2">
            <button id="chooseNounBtn" class="button is-warning" @click="chosenNoun = Math.floor(Math.random()*NOUNS.length); chosenArticle = Math.floor(Math.random()*ARTICLES.length); answer = ''; $refs.answerInput.focus()">choose again</button>
            </footer>
        </section>

        <section class="content" x-show="selected == 'phrases'" x-data="{
            chosenPhrase: 0,
        }"></br>
            <dl>
            <dt>You have chosen phrase:</dt>
            <dd><b x-text="PHRASES[chosenPhrase]"></b></dd>
            
            </dl>
            <footer class="mt-2">
            <button class="button is-warning" @click="chosenPhrase = Math.floor(Math.random()*PHRASES.length);">choose again</button>
            </footer>
        </section>

    </main>
</body>
<script src="https://unpkg.com/alpinejs@3.13.8" defer></script>
